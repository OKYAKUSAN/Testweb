<!doctype html>
<html>
<head>
<meta charset="utf-8">
<META HTTP-EQUIV="pragma" CONTENT="no-cache"> 
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store, must-revalidate"> 
<META HTTP-EQUIV="expires" CONTENT="Wed, 26 Feb 1997 08:21:57 GMT"> 
<META HTTP-EQUIV="expires" CONTENT="0"> 
<link type="text/css" rel="stylesheet" href="css/master.css">
<script type="text/javascript" src="js/jquery-1.12.4.min.js"></script>
<title>无标题文档</title>
</head>

<body>
	<!-- header -->
    <div class="top">
    	<div class="banner">
        	<div class="banner-layout">
        		<div class="logo"><img src="images/logo.png" alt="NBA"></div>
            </div>
        </div>
        <div class="nav">
        	<div class="nav-list">
            	<ul>
                	<li class="nav-list-li">
                    	<a href="index.html" class="nav-list-a">首页</a>
                    </li>
                	<li class="nav-list-li nav-tag">
                    	<a href="teamschedule.html?team=warriors" class="nav-list-a">球队</a>
                        <div class="teamsList">
                        	<div class="teamsList-header">
                            	<div>西部联盟</div>
                            	<div>东部联盟</div>
                            </div>
                            <div class="teamsList-main">
                            	<div class="area">
                                	<div class="area-header">太平洋赛区</div>
                                    <a href="teamschedule.html?team=warriors">
                                    	<div><img src="images/teams_logo/warriors.png" alt="warriors"></div>
                                        <span>勇士</span>
                                    </a>
                                    <a href="teamschedule.html?team=clippers" class="area_bg">
                                    	<div><img src="images/teams_logo/clippers.png" alt="clippers"></div>
                                        <span>快船</span>
                                    </a>
                                    <a href="teamschedule.html?team=kings">
                                    	<div><img src="images/teams_logo/kings.png" alt="kings"></div>
                                        <span>国王</span>
                                    </a>
                                    <a href="teamschedule.html?team=lakers" class="area_bg">
                                    	<div><img src="images/teams_logo/lakers.png" alt="lakers"></div>
                                        <span>湖人</span>
                                    </a>
                                    <a href="teamschedule.html?team=suns">
                                    	<div><img src="images/teams_logo/suns.png" alt="suns"></div>
                                        <span>太阳</span>
                                    </a>
                                </div>
                            	<div class="area">
                                	<div class="area-header">西北赛区</div>
                                    <a href="teamschedule.html?team=jazz">
                                    	<div><img src="images/teams_logo/jazz.png" alt="jazz"></div>
                                        <span>爵士</span>
                                    </a>
                                    <a href="teamschedule.html?team=thunder" class="area_bg">
                                    	<div><img src="images/teams_logo/thunder.png" alt="thunder"></div>
                                        <span>雷霆</span>
                                    </a>
                                    <a href="teamschedule.html?team=blazers">
                                    	<div><img src="images/teams_logo/blazers.png" alt="blazers"></div>
                                        <span>开拓者</span>
                                    </a>
                                    <a href="teamschedule.html?team=nuggets" class="area_bg">
                                    	<div><img src="images/teams_logo/nuggets.png" alt="nuggets"></div>
                                        <span>掘金</span>
                                    </a>
                                    <a href="teamschedule.html?team=timberwolves">
                                    	<div><img src="images/teams_logo/timberwolves.png" alt="timberwolves"></div>
                                        <span>森林狼</span>
                                    </a>
                                </div>
                            	<div class="area">
                                	<div class="area-header">西北赛区</div>
                                    <a href="teamschedule.html?team=spurs">
                                    	<div><img src="images/teams_logo/spurs.png" alt="spurs"></div>
                                        <span>马刺</span>
                                    </a>
                                    <a href="teamschedule.html?team=rockets" class="area_bg">
                                    	<div><img src="images/teams_logo/rockets.png" alt="rockets"></div>
                                        <span>火箭</span>
                                    </a>
                                    <a href="teamschedule.html?team=grizzlies">
                                    	<div><img src="images/teams_logo/grizzlies.png" alt="grizzlies"></div>
                                        <span>灰熊</span>
                                    </a>
                                    <a href="teamschedule.html?team=pelicans" class="area_bg">
                                    	<div><img src="images/teams_logo/pelicans.png" alt="pelicans"></div>
                                        <span>鹈鹕</span>
                                    </a>
                                    <a href="teamschedule.html?team=mavericks">
                                    	<div><img src="images/teams_logo/mavericks.png" alt="mavericks"></div>
                                        <span>独行侠</span>
                                    </a>
                                </div>
                            	<div class="area areaLine">
                                	<div class="area-header">东南赛区</div>
                                    <a href="teamschedule.html?team=hornets">
                                    	<div><img src="images/teams_logo/hornets.png" alt="hornets"></div>
                                        <span>黄蜂</span>
                                    </a>
                                    <a href="teamschedule.html?team=hawks" class="area_bg">
                                    	<div><img src="images/teams_logo/hawks.png" alt="hawks"></div>
                                        <span>老鹰</span>
                                    </a>
                                    <a href="teamschedule.html?team=wizards">
                                    	<div><img src="images/teams_logo/wizards.png" alt="wizards"></div>
                                        <span>奇才</span>
                                    </a>
                                    <a href="teamschedule.html?team=magic" class="area_bg">
                                    	<div><img src="images/teams_logo/magic.png" alt="magic"></div>
                                        <span>魔术</span>
                                    </a>
                                    <a href="teamschedule.html?team=heat">
                                    	<div><img src="images/teams_logo/heat.png" alt="heat"></div>
                                        <span>热火</span>
                                    </a>
                                </div>
                            	<div class="area">
                                	<div class="area-header">中部赛区</div>
                                    <a href="teamschedule.html?team=cavaliers">
                                    	<div><img src="images/teams_logo/cavaliers.png" alt="cavaliers"></div>
                                        <span>骑士</span>
                                    </a>
                                    <a href="teamschedule.html?team=bulls" class="area_bg">
                                    	<div><img src="images/teams_logo/bulls.png" alt="bulls"></div>
                                        <span>公牛</span>
                                    </a>
                                    <a href="teamschedule.html?team=pistons">
                                    	<div><img src="images/teams_logo/pistons.png" alt="pistons"></div>
                                        <span>活塞</span>
                                    </a>
                                    <a href="teamschedule.html?team=pacers" class="area_bg">
                                    	<div><img src="images/teams_logo/pacers.png" alt="pacers"></div>
                                        <span>步行者</span>
                                    </a>
                                    <a href="teamschedule.html?team=bucks">
                                    	<div><img src="images/teams_logo/bucks.png" alt="bucks"></div>
                                        <span>雄鹿</span>
                                    </a>
                                </div>
                            	<div class="area">
                                	<div class="area-header">大西洋赛区</div>
                                    <a href="teamschedule.html?team=raptors">
                                    	<div><img src="images/teams_logo/raptors.png" alt="raptors"></div>
                                        <span>猛龙</span>
                                    </a>
                                    <a href="teamschedule.html?team=knicks" class="area_bg">
                                    	<div><img src="images/teams_logo/knicks.png" alt="knicks"></div>
                                        <span>尼克斯</span>
                                    </a>
                                    <a href="teamschedule.html?team=celtics">
                                    	<div><img src="images/teams_logo/celtics.png" alt="celtics"></div>
                                        <span>凯尔特人</span>
                                    </a>
                                    <a href="teamschedule.html?team=nets" class="area_bg">
                                    	<div><img src="images/teams_logo/nets.png" alt="nets"></div>
                                        <span>篮网</span>
                                    </a>
                                    <a href="teamschedule.html?team=sixers">
                                    	<div><img src="images/teams_logo/sixers.png" alt="sixers"></div>
                                        <span>76人</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    
    <!-- main -->
    <div class="main">
    	<!--
        <div class="teamschedule-header">
            <div class="teamlogo fl">
                <div class="fl"><img src="images/teams_logo/sixers.png" alt=""></div>
                <span class="fl">76人</span>
            </div>
            <div class="teamrecord fl">
            	<span class="teamrecord-win">0</span>胜-<span class="teamrecord-lose">0</span>负
            </div>
        </div>
        -->
        <div class="teamschedule-header">
        	<div class="teamlogo fl">
            	<div class="teamlogo-img fl"><img src="images/teamlogo_default.jpg" alt=""></div>
                <div class="teamlogo-info fl">
                	<div class="teamlogo-cname"></div>
                    <div class="teamlogo-ename"></div>
                </div>
            </div>
            <div class="teamrecord fl">
            	<table class="teamrecord-table">
                	<colgroup>
                    	<col style="width:20%;">
                    	<col style="width:40%;">
                    	<col style="width:40%;">
                    </colgroup>
                	<tr>
                    	<th></th><th>胜负场</th><th>胜率</th>
                    </tr>
                    <tr>
                    	<th>总场</th><td class="record-total"></td><td></td>
                    </tr>
                    <tr>
                    	<th>主场</th><td class="record-home"></td><td></td>
                    </tr>
                    <tr>
                    	<th>客场</th><td class="record-away"></td><td></td>
                    </tr>
                </table>
            </div>
        </div>
        <!-- gamelist -->
        <div class="teamschedulelist">
        	<!--
        	<div class="tsl-item">
            	<div class="tsl-item-header">2018年10月</div>
                <ul>
                	<li>
                    	<div class="tsl-i-date">10月7日</div>
                        <div class="tsl-i-time">7:00</div>
                        <div class="tsl-i-away"><div><img src="images/teams_logo/warriors.png"></div><span>勇士</span></div>
                        <div class="tsl-i-vs"></div>
                        <div class="tsl-i-home"><div><img src="images/teams_logo/clippers.png"></div><span>快船</span></div>
                        <div class="tsl-i-result tsl-lose">未开始</div>
                    </li>
                </ul>
            </div>
            -->
        </div>
    </div>
    
    <!-- footer -->
    <div class="footer">
    	<div class="footer-main">
        	<div class="footer-logo"><img src="images/logo.png" alt="nba"></div>
            <div class="footer-content">
            	<div class="footer-link">
                	<a href="#">其它链接</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="#">其它链接</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="#">其它链接</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="#">其它链接</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="#">其它链接</a>&nbsp;&nbsp;|&nbsp;&nbsp;
                </div>
                <div class="footer-copyright">版权所有 ©2018 ZZ工作室</div>
            </div>
        </div>
    </div>
    
    <script type="text/javascript">
		$(function(){
			//初始化日历
			var calendarList = $(".calendar-list-item");
			var today = new Date();
			var tempDate = new Date();
			tempDate.setFullYear(2018);
			tempDate.setMonth(9,1);
			
			//导航
			$(".nav-tag").mouseenter(function(){
				$(this).children("div").show();
			}).mouseleave(function(){
				$(this).children("div").hide();
			});
			
			//比赛列表
			function GetQueryString(name)
			{
				var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
				var r = window.location.search.substr(1).match(reg);
				if(r!=null)return  unescape(r[2]); return null;
			}
			var teamName = GetQueryString("team");
			var tsl = $(".teamschedulelist");
			var teamlogo = $(".teamlogo");
			//var teamrecord_win = $(".teamrecord-win");
			//var teamrecord_lose = $(".teamrecord-lose");
			//var win = 0;
			//var lose = 0;
			var win_total = 0;		//总胜场数
			var win_home = 0;		//主场胜场数
			var win_away = 0;		//客场胜场数
			var lose_total = 0;		//总败场数
			var lose_home = 0;		//主场败场数
			var lose_away = 0;		//客场败场数
			var td_total = $(".record-total");
			var td_home = $(".record-home");
			var td_away = $(".record-away");
			var tempD = new Date();
			//读取队名列表
			$.ajax({
				url:"teamList.xml?" + tempD.getSeconds(),
				dataType:"xml",
				type:"GET",
				error:function(xml){
					alert("队名读取失败！");
				},
				success:function(xml){
					var _team;
					if(teamName == "nets"){
						_team = $(xml).find("ename:contains(" + teamName + ")").parent().eq(1);
					} else _team = $(xml).find("ename:contains(" + teamName + ")").parent();
					//teamlogo.find("img").attr("src", "images/teams_logo/" + team.children("ename").text() + ".png");
					//teamlogo.children("span").html(team.children("cname").text());
					var _strEname = _team.children("ename").text();
					var _arrayEname = _strEname.split("");
					_arrayEname[0] = _arrayEname[0].toUpperCase();
					_strEname = _arrayEname.join("");
					teamlogo.find(".teamlogo-cname").html(_team.children("ccity").text() + " " + _team.children("cname").text());
					teamlogo.find(".teamlogo-ename").html(_team.children("ecity").text() + " " + _strEname);
					teamlogo.find("img").attr("src", "images/teams_logo/b_" + _team.children("ename").text() + ".svg");
					
					$("title").html("赛程 - " + _team.children("ccity").text() + " " + _team.children("cname").text());
				}
			});
			//读取比赛列表
			$.ajax({
				url:"gameList.xml?" + tempD.getSeconds(),
				dataType:"xml",
				type:"GET",
				error:function(xml){
					alert("读取数据失败！");
				},
				success:function(xml){
					var _currentGameMonth = -1;
					var _tempGameMonth;
					$(xml).find("game").each(function(){
						if($(this).find("[eName="+teamName+"]").length == 1){
							_tempGameMonth = $(this).attr("month");
							if(_tempGameMonth != _currentGameMonth){
								tsl.append("<div class='tsl-item'><div class='tsl-item-header'>" + $(this).attr("year") + "年" + _tempGameMonth + "月" + "</div><ul></ul></div>");
								_currentGameMonth = _tempGameMonth;
							}
							var _tsl = tsl.find("ul:last");
							_tsl.append("<li><div class='tsl-i-date'>" + $(this).attr("month") + "月" + $(this).attr("date") + "日" + "</div><div class='tsl-i-time'>" + $(this).children("time").text() + "</div><div class='tsl-i-away'><div><img src='images/teams_logo/" + $(this).children("away").attr("eName") + ".png'></div><span>" + $(this).children("away").text() + "</span></div><div class='tsl-i-vs'></div><div class='tsl-i-home'><div><img src='images/teams_logo/" + $(this).children("home").attr("eName") + ".png'></div><span>" + $(this).children("home").text() + "</span></div><div class='tsl-i-result'>" + $(this).children("result").text() + "</div></li>");
							
							//判断并统计胜败
							var score = $(this).children("result").text().split("-");
							if(score.length == 2){
								var _awayScore, _homeScore;
								_awayScore = parseInt(score[0]);
								_homeScore = parseInt(score[1]);
								var _lastgame = _tsl.find(".tsl-i-result:last");
								if($(this).children("away").attr("eName") == teamName){
									if(_awayScore > _homeScore) {
										_lastgame.addClass("tsl-win");
										win_total++;
										win_away++;
									}
									else if(_awayScore < _homeScore) {
										_lastgame.addClass("tsl-lose");
										lose_total++;
										lose_away++;
									}
								} else if($(this).children("home").attr("eName") == teamName){
									if(_awayScore > _homeScore) {
										_lastgame.addClass("tsl-lose");
										lose_total++;
										lose_home++;
									}
									else if(_awayScore < _homeScore) {
										_lastgame.addClass("tsl-win");
										win_total++;
										win_home++;
									}
								}
							}
						}
					});
					//teamrecord_win.html(win);
					//teamrecord_lose.html(lose);
					var _probability = 0;
					td_total.html(win_total + "-" + lose_total);
					td_home.html(win_home + "-" + lose_home);
					td_away.html(win_away + "-" + lose_away);
					if(win_total + lose_total != 0){
						_probability = parseFloat(win_total) / parseFloat(win_total + lose_total) * 100;
						td_total.next().html(_probability.toFixed(1) + "%");
						if(win_home + lose_home != 0){
							_probability = parseFloat(win_home) / parseFloat(win_home + lose_home) * 100;
							td_home.next().html(_probability.toFixed(1) + "%");
						} else{ td_home.next().html("--");}
						if(win_away + lose_away != 0){
							_probability = parseFloat(win_away) / parseFloat(win_away + lose_away) * 100;
							td_away.next().html(_probability.toFixed(1) + "%");
						} else{ td_away.next().html("--");}
					} else{
						td_total.next().html("--");
						td_home.next().html("--");
						td_away.next().html("--");
					}
				}
			});
			
			tsl.delegate(".tsl-item-header","click",function(){
				$(this).next().slideToggle("fast");
			});
		});
	</script>
</body>
</html>
